"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var __defProp=Object.defineProperty,__name=(e,r)=>__defProp(e,"name",{value:r,configurable:!0}),_center=require("@turf/center"),_jsts=require("@turf/jsts"),_jsts2=_interopRequireDefault(_jsts),_meta=require("@turf/meta"),_d3geo=require("d3-geo"),_helpers=require("@turf/helpers"),{BufferOp:BufferOp,GeoJSONReader:GeoJSONReader,GeoJSONWriter:GeoJSONWriter}=_jsts2.default;function buffer(e,r,t){var o=(t=t||{}).units||"kilometers",u=t.steps||8;if(!e)throw new Error("geojson is required");if("object"!==typeof t)throw new Error("options must be an object");if("number"!==typeof u)throw new Error("steps must be an number");if(void 0===r)throw new Error("radius is required");if(u<=0)throw new Error("steps must be greater than 0");var a=[];switch(e.type){case"GeometryCollection":return _meta.geomEach.call(void 0,e,(function(e){var t=bufferFeature(e,r,o,u);t&&a.push(t)})),_helpers.featureCollection.call(void 0,a);case"FeatureCollection":return _meta.featureEach.call(void 0,e,(function(e){var t=bufferFeature(e,r,o,u);t&&_meta.featureEach.call(void 0,t,(function(e){e&&a.push(e)}))})),_helpers.featureCollection.call(void 0,a)}return bufferFeature(e,r,o,u)}function bufferFeature(e,r,t,o){var u=e.properties||{},a="Feature"===e.type?e.geometry:e;if("GeometryCollection"===a.type){var n=[];return _meta.geomEach.call(void 0,e,(function(e){var u=bufferFeature(e,r,t,o);u&&n.push(u)})),_helpers.featureCollection.call(void 0,n)}var f=defineProjection(a),i={type:a.type,coordinates:projectCoords(a.coordinates,f)},s=(new GeoJSONReader).read(i),c=_helpers.radiansToLength.call(void 0,_helpers.lengthToRadians.call(void 0,r,t),"meters"),d=BufferOp.bufferOp(s,c,o);if(!coordsIsNaN((d=(new GeoJSONWriter).write(d)).coordinates)){var l={type:d.type,coordinates:unprojectCoords(d.coordinates,f)};return _helpers.feature.call(void 0,l,u)}}function coordsIsNaN(e){return Array.isArray(e[0])?coordsIsNaN(e[0]):isNaN(e[0])}function projectCoords(e,r){return"object"!==typeof e[0]?r(e):e.map((function(e){return projectCoords(e,r)}))}function unprojectCoords(e,r){return"object"!==typeof e[0]?r.invert(e):e.map((function(e){return unprojectCoords(e,r)}))}function defineProjection(e){var r=_center.center.call(void 0,e).geometry.coordinates,t=[-r[0],-r[1]];return _d3geo.geoAzimuthalEquidistant.call(void 0).rotate(t).scale(_helpers.earthRadius)}__name(buffer,"buffer"),__name(bufferFeature,"bufferFeature"),__name(coordsIsNaN,"coordsIsNaN"),__name(projectCoords,"projectCoords"),__name(unprojectCoords,"unprojectCoords"),__name(defineProjection,"defineProjection");var turf_buffer_default=buffer;exports.buffer=buffer,exports.default=turf_buffer_default;